{
  "name": "Prenotazione appuntamento",
  "slug": "prenotazione-appuntamento",
  "topic": "ambiente",
  "description": "Il servizio permette di richiedere un appuntamento all’amministrazione comunale.",
  "short_description": "Un servizio aperto a tutti i cittadini per richiedere un appuntamento",
  "howto": "Invia una richiesta di un appuntamento online dal tuo smartphone o computer",
  "how_to_do": "Si può inviare una richiesta di un appuntamento online da smartphone o computer, oppure presso lo sportello",
  "what_you_need": "",
  "what_you_get": "Chi richiede un appuntamento online identificandosi con identità digitale riceverà, tramite posta elettronica, gli aggiornamenti sullo stato di avanzamento della richiesta.",
  "costs": "Il servizio è gratuito",
  "who": "Possono richiedere un appuntamento tutte le persone residenti e non residenti nel comune.",
  "conditions": "Per conoscere i dettagli di scadenze, requisiti e altre informazioni importanti, leggi i termini e le condizioni di servizio.",
  "access_level": 0,
  "workflow": 1,
  "identifier": "bookings",
  "status": 3,
  "form": {
    "display": "wizard",
    "type": "form",
    "components": [
      {
        "title": "LUOGO",
        "breadcrumbClickable": true,
        "buttonSettings": {
          "previous": true,
          "cancel": true,
          "next": true
        },
        "navigateOnEnter": false,
        "saveOnEnter": false,
        "scrollToTop": false,
        "collapsible": false,
        "key": "page1",
        "type": "panel",
        "label": "Page 3",
        "components": [
          {
            "legend": "Ufficio",
            "key": "fieldSet",
            "type": "fieldset",
            "label": "Field Set",
            "input": false,
            "tableView": false,
            "components": [
              {
                "label": "Ufficio selezionato",
                "widget": "html5",
                "placeholder": "Seleziona opzione",
                "tableView": true,
                "dataSrc": "custom",
                "data": {
                  "custom": "async function get_data() {\n  window.FormioHelper.authenticatedCall(\"calendars?type=time_fixed_slots\")\n  .then(\n    function(promise) {\n      instance.setItems(promise)\n    })\n}\n\nif (values.length === 0) {\n  get_data()\n}"
                },
                "valueProperty": "id",
                "template": "<span>{{ item.title }}</span>",
                "validate": {
                  "required": true,
                  "custom": "console.log(data);"
                },
                "key": "calendar_id",
                "type": "select",
                "input": true
              }
            ]
          }
        ],
        "input": false,
        "tableView": false
      },
      {
        "title": "DATA E ORARIO",
        "breadcrumbClickable": true,
        "buttonSettings": {
          "previous": true,
          "cancel": true,
          "next": true
        },
        "navigateOnEnter": false,
        "saveOnEnter": false,
        "scrollToTop": false,
        "collapsible": false,
        "key": "page4",
        "type": "panel",
        "label": "Page 4",
        "input": false,
        "tableView": false,
        "components": [
          {
            "legend": "Appuntamenti disponibili",
            "key": "fieldSet3",
            "type": "fieldset",
            "label": "Field Set",
            "input": false,
            "tableView": false,
            "components": [
              {
                "label": "Giorno selezionato",
                "widget": "html5",
                "placeholder": "Seleziona il giorno",
                "tableView": true,
                "dataSrc": "custom",
                "data": {
                  "custom": "async function get_data(id) {\n  var dates = [];\n  window.FormioHelper.authenticatedCall(\"calendars/\" + id + \"/availabilities\").then(function(promise) {\n    var options = {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'};\n    promise.forEach(function(item) {\n      dates.push({\n        datestring: new Date(item.date).toLocaleDateString('it-IT', options), \n        date: item.date\n      });\n    });\n    instance.setItems(dates);\n  })\n}\n\nif (values.length === 0) {\n  get_data(data.calendar_id)\n}"
                },
                "valueProperty": "date",
                "template": "<span>{{ item.datestring }}</span>",
                "validate": {
                  "required": true
                },
                "key": "day",
                "type": "select",
                "input": true
              },
              {
                "label": "Orario selezionato",
                "widget": "html5",
                "placeholder": "Seleziona l'orario",
                "tableView": true,
                "dataSrc": "custom",
                "data": {
                  "custom": "async function get_data(id, day) {\n  window.FormioHelper.authenticatedCall(\"calendars/\" + id + \"/availabilities/\" + day + \"?available=available\")\n  .then(function(promise) {\n    instance.setItems(promise)\n  })\n}\n\nif (values.length === 0) {\n  get_data(data.calendar_id, data.day)\n}"
                },
                "template": "<span>{{ item.start_time }} - {{ item.end_time }}</span>",
                "validate": {
                  "required": true
                },
                "key": "time",
                "type": "select",
                "input": true
              },
              {
                "label": "Meeting",
                "calculateValue": "/*async function get_meeting() {\n  window.FormioHelper.authenticatedCall(\"/meetings/new-draft\")\n  .then(function(promise) {\n    instance.setItems(promise)\n  })\n}\n\nif (data.meeting_id) {\n  if (data.day && data.calendar && data.time.start_time && data.time.opening_hour) {\n    get_meeting()\n  }\n}*/\n",
                "key": "meeting_id",
                "type": "hidden",
                "input": true,
                "tableView": false
              },
              {
                "label": "Data e ora",
                "calculateValue": "day = data.day.split(\"-\")\nday = day[2] + \"/\" + day[1] + \"/\" + day[0];\ndata.calendar = day + \" @ \" + data.time.start_time + \"-\" + data.time.end_time + \" (\" + data.calendar_id + \"#\" + data.meeting_id + \"#\"+ data.time.opening_hour + \")\";\n\n",
                "key": "calendar",
                "type": "hidden",
                "input": true,
                "tableView": false
              }
            ]
          }
        ]
      },
      {
        "title": "DETTAGLI APPUNTAMENTO",
        "breadcrumbClickable": true,
        "buttonSettings": {
          "previous": true,
          "cancel": true,
          "next": true
        },
        "navigateOnEnter": false,
        "saveOnEnter": false,
        "scrollToTop": false,
        "collapsible": false,
        "key": "page5",
        "type": "panel",
        "label": "Page 5",
        "components": [
          {
            "legend": "Motivo",
            "key": "fieldSet1",
            "type": "fieldset",
            "label": "Field Set",
            "input": false,
            "tableView": false,
            "components": [
              {
                "label": "Aggiungi il motivo dell'appuntamento",
                "tableView": true,
                "validate": {
                  "required": true
                },
                "key": "user_message",
                "type": "textfield",
                "input": true
              }
            ]
          },
          {
            "legend": "Dettagli",
            "key": "fieldSet2",
            "type": "fieldset",
            "label": "Field Set",
            "input": false,
            "tableView": false,
            "components": [
              {
                "label": "Aggiungi ulteriori dettagli",
                "tableView": true,
                "key": "details",
                "type": "textfield",
                "input": true
              }
            ]
          }
        ],
        "input": false,
        "tableView": false
      },
      {
        "title": "RICHIEDENTE",
        "breadcrumbClickable": true,
        "buttonSettings": {
          "previous": true,
          "cancel": true,
          "next": true
        },
        "navigateOnEnter": false,
        "saveOnEnter": false,
        "scrollToTop": false,
        "collapsible": false,
        "key": "page1",
        "type": "panel",
        "label": "Page 1",
        "components": [
          {
            "legend": "Richiedente",
            "key": "fieldSet",
            "type": "fieldset",
            "label": "Field Set",
            "input": false,
            "tableView": false,
            "components": [
              {
                "label": "applicant",
                "tableView": true,
                "form": "5e5e26ede170600020175850",
                "useOriginalRevision": false,
                "key": "applicant",
                "type": "form",
                "input": true,
                "lazyLoad": true
              }
            ]
          }
        ],
        "input": false,
        "tableView": false
      }
    ],
    "tags": [
      "custom"
    ],
    "title": "bookings",
    "name": "bookings",
    "path": "bookings",
    "description": "bookings"
  }
}


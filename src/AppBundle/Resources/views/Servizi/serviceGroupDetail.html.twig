{% extends '@App/Default/index.html.twig' %}
{% block title %}{{ servizio.name }} - Stanza del cittadino{% endblock %}

{% block main_content %}

  <section class="container">
    <div class="row">
      <div class="col-lg-8 px-lg-4 py-lg-2">
        <h1>{{ servizio.name }}</h1>
      </div>
      <div class="col-lg-3 offset-lg-1">
        <div class="mt-4 mb-4">
          {% if servizio.coverage %}
            {% if servizio.coverage|length > 0 %}
              <article class="mb-4">
                <h6><small>{{ 'gruppo_di_servizi.copertura' | trans }}</small></h6>
                {% for c in servizio.coverage %}
                  <div class="chip chip-primary chip-simple mr-2">
                    <span class="chip-label">{{ c }}</span>
                  </div>
                {% endfor %}
              </article>
            {% endif %}
          {% endif %}
        </div>
      </div>
    </div>
    <div class="row border-top row-column-border row-column-menu-left">
      <aside class="col-lg-4" style="position: relative;">
        <div class="sticky-wrapper navbar-wrapper">
          <nav class="navbar it-navscroll-wrapper it-top-navscroll navbar-expand-lg">
            <button class="custom-navbar-toggler" type="button" aria-controls="navbarNav" aria-expanded="false"
                    aria-label="Toggle navigation" data-target="#navbarNav">
              <span class="it-list"></span>{{ 'servizio.indice' | trans }}
            </button>
            <div class="navbar-collapsable" id="navbarNav">
              <div class="menu-wrapper">
                <div class="link-list-wrapper menu-link-list">
                  <h3 class="no_toc">{{ 'servizio.indice' | trans }}</h3>
                  <ul class="link-list">
                    {% if servizio.description|striptags|trim != '' %}
                      <li class="nav-item">
                        <a class="nav-link" aria-selected="true"  aria-disabled="true" tabindex="-1"
                           href="#description"><span>
                          {{ 'gruppo_di_servizi.cos_e' | trans }}
                        </span>
                        </a>
                      </li>
                    {% endif %}
                    {% if servizio.who|striptags|trim != '' %}
                      <li class="nav-item">
                        <a class="nav-link" aria-selected="true"  aria-disabled="true" tabindex="-1"
                           href="#who"><span>{{ 'gruppo_di_servizi.a_chi_si_rivolge' | trans }}</span></a>
                      </li>
                    {% endif %}
                    {% if servizio.howto|striptags|trim != '' %}
                      <li class="nav-item">
                        <a class="nav-link" aria-selected="true"  aria-disabled="true" tabindex="-1"
                           href="#howto"><span>{{ 'gruppo_di_servizi.accedere' | trans }}</span></a>
                      </li>
                    {% endif %}
                    {% if servizio.specialCases|striptags|trim != '' %}
                      <li class="nav-item">
                        <a class="nav-link" aria-selected="true"  aria-disabled="true" tabindex="-1"
                           href="#special-cases"><span>{{ 'gruppo_di_servizi.casi_particolari' | trans }}</span></a>
                      </li>
                    {% endif %}
                    {% if servizio.moreInfo|striptags|trim != '' %}
                      <li class="nav-item">
                        <a class="nav-link" aria-selected="true"  aria-disabled="true" tabindex="-1"
                           href="#more-info"><span>{{ 'gruppo_di_servizi.maggiori_info' | trans }}</span></a>
                      </li>
                    {% endif %}
                  </ul>
                </div>
              </div>
            </div>
          </nav>
        </div>
      </aside>
      <section class="col-lg-8">
        {% if servizio.description|striptags|trim != '' %}
          <article id="description" class="anchor-offset">
            <h4>{{ 'servizio.cos_e' | trans }}</h4>
            {{ servizio.description|cleanMarkup|raw|nl2br }}
          </article>
        {% endif %}
        {% if servizio.who|striptags|trim != '' %}
          <article id="who" class="anchor-offset">
            <h4>{{ 'servizio.a_chi_si_rivolge' | trans }}</h4>
            {{ servizio.who|cleanMarkup|raw|nl2br }}
          </article>
        {% endif %}
        {% if servizio.howto|striptags|trim != '' %}
          <article id="howto" class="anchor-offset">
            <h4>{{ 'servizio.accedere' | trans }}</h4>
            {{ servizio.howto|replace({'%comune%': instance_service.getCurrentInstance().name})|cleanMarkup|raw|nl2br }}
          </article>
        {% endif %}
        {% if servizio.specialCases|striptags|trim != '' %}
          <article id="special-cases" class="anchor-offset">
            <h4>{{ 'servizio.casi_particolari' | trans }}</h4>
            {{ servizio.specialCases|replace({'%comune%': instance_service.getCurrentInstance().name})|cleanMarkup|raw|nl2br }}
          </article>
        {% endif %}
        {% if servizio.moreInfo|striptags|trim != '' %}
          <article id="more-info" class="anchor-offset">
            <h4>{{ 'servizio.maggiori_info' | trans }}</h4>
            {{ servizio.moreInfo|replace({'%comune%': instance_service.getCurrentInstance().name})|cleanMarkup|raw|nl2br }}
          </article>
        {% endif %}
      </section>
    </div>
  </section>

  <section class="container py-5">
    <div class="row d-flex flex-wrap">
      {% for sharedService in servizio.getSharedServices %}
        {% set serviceUrl = path('pratiche_anonime_new', {'servizio': sharedService.slug}) %}
        {% if sharedService.accessLevel > 0 or sharedService.accessLevel is null %}
          {% set serviceUrl = path('pratiche_new', {'servizio': sharedService.slug}) %}
        {% endif %}
        <div class="col-12 col-md-6 px-lg-4 mb-2">
          <a href="{{ serviceUrl }}"
             class="btn btn-primary btn-lg d-flex flex-column justify-content-center h-100 service-access-button">
            {{ sharedService.name }}
          </a>
        </div>
      {% endfor %}
    </div>
  </section>

  {% if servizio.getStickyServices.count > 0 %}
    <section class="container-fluid py-5 bg-light">
      <div class="container">
        <div class="row">
          {% for servizio in servizio.getStickyServices %}
            <div class="col-12">
              {{ include('@App/Servizi/parts/panel/servizio_sticky.html.twig') }}
            </div>
          {% endfor %}
        </div>
      </div>
    </section>
  {% endif %}

  {% if servizio.getNotStickyServices.count > 0 %}
    <section class="container py-5">
      <div class="row">
        {% for item in servizio.getNotStickyServices %}
          <div class="col-12 col-sm-6 col-lg-4">
            {{ include('@App/Servizi/parts/panel/servizio.html.twig', {'servizio':item}) }}
          </div>
        {% endfor %}
      </div>
    </section>
  {% endif %}

{% endblock %}

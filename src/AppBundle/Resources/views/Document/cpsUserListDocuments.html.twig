{% extends '@App/Default/index.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
{% endblock %}
{% block javascripts %}
    {{ parent() }}
{% endblock %}
{% block main_content %}

    <section id="intro" class="container px-4 my-4">
        <div class="row">
            <div class="col-12 px-lg-4 py-lg-2">
                <h1>
                  <a class="text-decoration-none" href="{{ path('folders_list_cpsuser') }}">
                    <svg class="icon icon-xl icon-primary">
                      <use xlink:href="/bootstrap-italia/dist/svg/sprite.svg#it-chevron-left"></use>
                    </svg>
                  </a>
                  {{'documenti.i_miei_documenti' | trans}}: {{ folder.title }}
                </h1>
                <p>{{ folder.description }}</p>
            </div>
            <div class="col-12 px-lg-4 py-lg-2 my-5">
                {% if documents is empty %}
                    <p>{{'documenti.cartella.no_documenti' | trans}}</p>
                {% else %}
                  <table id="folders_table" class="table border-bottom">
                    <th class="d-none d-none d-lg-table-cell">
                      <div class="px-2 py-2 font-weight-light">{{'documenti.documento.nome' | trans}}</div>
                    </th>
                    <th class="d-none d-none d-lg-table-cell">
                      <div class="px-2 py-2 font-weight-light">{{'documenti.documento.data_creazione' | trans}}</div>
                    </th>
                    <th class="d-none d-none d-lg-table-cell">
                      <div class="px-2 py-2 font-weight-light">{{'documenti.documento.valido' | trans}}</div>
                    </th>
                    <th class="d-none d-none d-lg-table-cell"></th>
                    <th class="d-none d-none d-lg-table-cell"></th>
                    <th class="d-none d-none d-lg-table-cell"></th>
                    {% for document in documents %}
                      <tr>
                        <td>
                          <div class="px-2 py-2">
                            {% if document.recipientType == 'tenant' %}
                              <svg class="icon mr-4">
                                <use xlink:href="/bootstrap-italia/dist/svg/sprite.svg#it-file"></use>
                              </svg>
                            {% else %}
                              <svg class="icon mr-4">
                                <use xlink:href="/bootstrap-italia/dist/svg/sprite.svg#it-clip"></use>
                              </svg>
                            {% endif %}
                            {{ document.title }}
                          </div>
                        </td>
                        <td class="d-none d-none d-lg-table-cell">
                          <div class="px-2 py-2">
                            {{ document.createdAt | date('d/m/Y') }}
                          </div>
                        </td>
                        <td class="d-none d-none d-lg-table-cell">
                          <div class="px-2 py-2">
                            {%  if document.expireAt %}
                              {{ document.expireAt | date('d/m/Y') }}
                            {% else %}
                              ---
                            {% endif %}
                          </div>
                        </td>
                        <td class="d-none d-none d-lg-table-cell">
                          {% if document.expireAt and document.expireAt | date('c') < "now" | date_modify("+7 day")| date('c') %}
                            <svg class="icon icon-danger icon-lg">
                              <use xlink:href="/bootstrap-italia/dist/svg/sprite.svg#it-warning-circle"></use>
                            </svg>
                          {% endif %}
                        </td>
                        <td class="d-none d-none d-lg-table-cell">
                          <div class="float-right">
                            <a id="downloadDocument"
                               href="{{ path('document_download_cpsuser', {'folderSlug':folder.slug, 'documentId': document.id}) }}"
                               download>
                              <svg class="icon icon-primary">
                                <use xlink:href="/bootstrap-italia/dist/svg/sprite.svg#it-download"></use>
                              </svg>
                            </a>
                          </div>
                        </td>
                        <td>
                          <div class="float-right">
                            <a href="{{ path('documento_show_cpsuser', {'folderSlug': folder.slug, 'documentId': document.id}) }}">
                              <svg class="icon icon-lg icon-primary">
                                <use xlink:href="/bootstrap-italia/dist/svg/sprite.svg#it-chevron-right"></use>
                              </svg>
                            </a>
                          </div>
                        </td>
                      </tr>
                    {% endfor %}
                  </table>
                {% endif %}

                <table id="folders_table" class="table border-bottom mt-5">
                    <tr>
                        <td><strong>{{'documenti.cartella.data_creazione' | trans}}</strong></td>
                        <td>{{ folder.createdAt | date('d/m/Y') }}</td>
                    </tr>
                    <tr>
                        <td class="align-middle"><strong>{{'documenti.cartella.servizi_correlati' | trans}}</strong></td>
                        <td>
                            {% for service in folder.correlatedServices %}
                                <div><a href="{{ path('servizi_show', {'slug': service.slug}) }}">{{ service.name }}
                                </div>
                            {% endfor %}
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </section>
{% endblock %}

